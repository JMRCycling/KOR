<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KOR | Login</title>
    <link type="text/css" rel="stylesheet" href="../styles/styles.css" />
    <link rel="icon" href="../images/KOR_app_Logo.png" />
    <script defer src="../shop_tools/login_script.js"></script>
    <!--used during development, if development is buggy. Try commenting out this line-->
    <script
      defer
      src="https://jmrcycling.com/shop_tools/login_script.js"
    ></script>
    <!-- <script defer>

        const login = document.getElementById("login");
        console.log(login)

        login.addEventListener("submit", (e) => {
            e.preventDefault();

            console.log('form has been submitted');
            var myHeaders = new Headers();
            myHeaders.append("Content-Type", "application/x-www-form-urlencoded");

            var urlencoded = new URLSearchParams();
            var email = document.getElementById("email").value;
            urlencoded.append("email", email);
            var password = document.getElementById("password").value;
            urlencoded.append("password", password);

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: urlencoded,
                redirect: 'follow'
            };

            fetch("https://masontuft.com/loginShop", requestOptions)
                .then(response => response.json())
                .then(result => {
                    console.log(('plan type ' + result.plan_type[0].plan_type));
                    console.log(('shop_name ' + result.plan_type[0].shop_name));
                    
                    window.location.replace("https://jmrcycling.github.io/WDD130/KOR/shop_tools/dashboard?plan_type=" + result.plan_type[0].plan_type + "&shop_name=" + result.plan_type[0].shop_name);
                })
                .catch(error => console.log('error', error));

        })

    </script> -->
  </head>
  <script>
    var res = document.cookie;
    var multiple = res.split(';');
    for (var i = 0; i < multiple.length; i++) {
      var key = multiple[i].split('=');
      document.cookie = key[0] + ' =; expires = Thu, 01 Jan 1970 00:00:00 UTC';
    }
  </script>
  <body onload="checkAuth()">
    <header class="header">
      <div id="header_grid">
        <a href="../index.html" target="_parent">
          <img class="icon" src="../images/KOR_app_Logo.png" alt="KOR Logo" />
        </a>

        <!-- Desktop Navigation -->
        <nav class="desktop-nav">
          <a class="link" href="../index.html" target="_parent">Home</a>
          <a class="link" href="../sign_up.html" target="_parent"
            >Shop Sign Up</a
          >
          <a class="link" href="../our_story.html" target="_parent"
            >Our Story</a
          >
          <a class="link" href="../contact_us.html" target="_parent"
            >Contact Us</a
          >
          <a class="link" href="./login.html" target="_blank">Log In</a>
        </nav>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>

        <nav class="desktop-nav"></nav>
      </div>

      <!-- Mobile Navigation -->
      <nav class="mobile-nav" id="mobile-nav">
        <a class="mobile-link" href="../index.html" target="_parent">Home</a>
        <a class="mobile-link" href="../sign_up.html" target="_parent"
          >Shop Sign Up</a
        >
        <a class="mobile-link" href="../our_story.html" target="_parent"
          >Our Story</a
        >
        <a class="mobile-link" href="../contact_us.html" target="_parent"
          >Contact Us</a
        >
        <a class="mobile-link" href="./login.html" target="_blank">Log In</a>
      </nav>
    </header>

    <main>
      <!-- Working form -->
      <!-- <div class="login_window">
            <h1>Login</h1>
            <form id="login" class="login_form">
                <div class="form_line">
                    <label for="email">Email: </label>
                    <input type="email" id="email" name="email" placeholder="Youraddress@example.com" required>
                </div>
                <div class="form_line">
                    <label for="password">Password: </label>
                    <input type="password" id="password" name="password" placeholder="Password" required>
                </div>
                <div class="form_line">
                    <button class="link" type="submit">Submit</button>
                </div>
            </form>
        </div> -->

      <div class="login_window">
        <h1>Log In With Auth0</h1>
        <div class="center">
          <img
            style="width: 50%; border-radius: 15%"
            src="../images/Auth0_Logo.webp"
          />
        </div>

        <!-- <div id="login-error-msg-holder">
                <p id="login-error-msg">Invalid username <span id="error-msg-second-line">and/or password</span></p>
            </div>          
            <form id="login">
                    <div class="input_field">
                        <input type="email" id="email" name="email" placeholder="" required>
                        <label>Enter Email Here!</label>
                        <span></span>
                        
                    </div>
                    <div class="input_field">
                        <input type="password" id="password" name="password" placeholder="" required>
                        <label>Enter Password Here!</label>
                        <span></span>
                    </div>

                    <button class="btn" type="submit">Log In</button>

            </form> -->
        <div class="center">
          <button id="btn-login" class="link" disabled="true" onclick="login()">
            Log in
          </button>
        </div>
        <!-- Not Visible -->
        <button
          style="display: none"
          id="btn-logout"
          disabled="true"
          onclick="logout()"
        >
          Log out
        </button>

        <!-- <label>
                  Access token:
                  <pre id="ipt-access-token"></pre>
                </label>
                <label>
                  User profile:
                  <pre id="ipt-user-profile"></pre>
                </label> -->
      </div>
    </main>

    <footer>
      <div class="footer">
        <h3>KOR &copy; 2022 - Mason Tuft</h3>
        <h3>
          <a class="link" href="site-plan.html" target="_parent">Site Plan</a>
        </h3>
        <h3>
          <a class="link" href="contact_us.html" target="_parent">Contact Us</a>
        </h3>
        <div class="social">
          <a href="https://facebook.com" target="_blank">
            <img src="../images/facebook.png" alt="FB Icon" />
          </a>

          <a href="https://instagram.com" target="_blank">
            <img src="../images/instagram.png" alt="instagram icon" />
          </a>
        </div>
      </div>
      <!-- <iframe class="footer" src="../footer.html"   scrolling="no"></iframe> -->
    </footer>
    <!-- <script>
        const name = document.getElementById('user_name')
        const password = document.getElementById('password')
        const form = document.getElementById('form')
         form.addEventListener('submit', (e) => {
            let messages = []
            if (name.value ==='' || name.value == null) {
                messages.push('Name is required')
            }

            if (password.value.length <= 6) {
                messages.push('Password must be longer than 6 characters')
            }

            if (password.value.length >= 20) {
                messages.push('Password cannot be password')
            }

            if (password.value === 'password') {
                messages.push('Password cannot be password')
            }
            if (messages.length > 0) {
                e.preventDefault()
                errorElement.innerText = messages.join(', ')
            }
        })
    </script> -->
    <script src="https://cdn.auth0.com/js/auth0-spa-js/1.20/auth0-spa-js.production.js"></script>
    <script src="./login_script.js"></script>
    <script>
      function toggleMobileMenu() {
        const mobileNav = document.getElementById('mobile-nav');
        mobileNav.classList.toggle('active');
      }
    </script>
  </body>
  <!-- <script>
    const name = document.getElementById('user_name')
    const password = document.getElementById('password')
    const form = document.getElementById('form')
     form.addEventListener('submit', (e) => {
        let messages = []
        if (name.value ==='' || name.value == null) {
            messages.push('Name is required')
        }

        if (password.value.length <= 6) {
            messages.push('Password must be longer than 6 characters')
        }

        if (password.value.length >= 20) {
            messages.push('Password cannot be password')
        }

        if (password.value === 'password') {
            messages.push('Password cannot be password')
        }
        if (messages.length > 0) {
            e.preventDefault()
            errorElement.innerText = messages.join(', ')
        }
    })
</script> -->
</html>
